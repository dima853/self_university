### Псевдослучайные генераторы: когда короткий секрет создает длинную случайность

**Суть проблемы**  
Настоящая случайность — дорогой ресурс. Генерировать аппаратно миллионы битов для шифрования — медленно и неэффективно.  

**Решение**  
Берем короткое *истинно случайное* значение — **seed** (зерно) — и «растягиваем» его в длинную псевдослучайную последовательность. Алгоритм, который это делает, называется **PRG**.  

**Ключевое требование**  
Выход PRG должен быть **неотличим от истинно случайной строки** для любого, кто не знает исходный seed. Никаких статистических аномалий, никаких паттернов — только хаос, который проходит все тесты на случайность.  

---

### Формальные критерии

1. **Расширение (Expansion)**  
   Длина выхода `l(n)` должна быть строго больше длины входа `n`.  
   *Иначе какой смысл?*

2. **Псевдослучайность (Pseudorandomness)**  
   Для любого эффективного алгоритма-различителя `D` вероятность отличить вывод `G(s)` от истинно случайной строки должна быть пренебрежимо малой:  

   ```                                          
   | Pr[D(G(s)) = 1] - Pr[D(r) = 1] | ≤ negl(n)
   ```

   где `s` — случайный seed, `r` — истинно случайная строка.

---

### Почему это работает не для всех

Рассмотрим пример **нестойкого PRG**:  
`G(s) = s || (s[0] ⊕ s[1] ⊕ ... ⊕ s[n-1])`  
Мы просто добавляем к seed'у XOR всех его битов.

Такой генератор ломается элементарно:  
- Для выхода `G(s)` последний бит *всегда* равен XOR предыдущих битов  
- Для случайной строки это верно лишь в половине случаев  

Любой различитель легко заметит эту закономерность. Настоящий PRG не должен оставлять таких следов.

---

### Философский парадокс

Распределение выходов PRG **категорически не равномерно**.  
Если `G` удваивает длину (`l(n) = 2n`), то:
- Возможных выходов: `2^(2n)`  
- Доступных выходов: не более `2^n`  
- Вероятность случайно попасть в диапазон `G`: `2^n / 2^(2n) = 2^(-n)`

Получается, большинство строк длины `2n` никогда не появятся на выходе генератора. Но вся хитрость в том, что **полиномиальный противник не может этого заметить**. 

Если бы у нас было неограниченное время, мы бы легко отличали псевдослучайные строки от истинно случайных. Но в реальном мире время — наш главный союзник.

---

### Практические следствия

**Длина seed'а** — как криптографический ключ:
- Должна быть достаточной, чтобы перебор `2^n` вариантов был невозможен
- Должна храниться в секрете — знание seed'а полностью вскрывает генератор

**Существование PRG** — открытый вопрос, но:
- Есть практические кандидаты (поточные шифры)
- Теоретически можно построить из односторонних функций
- Для большинства приложений достаточно предположения, что они существуют

---

**Итог**: PRG — это мост между ограниченной истинной случайностью и безграничными потребностями криптографии. Не идеальный, но достаточно хороший для реального мира, где у противника нет вечности на взлом.

### PRF (Псевдослучайная функция)

Бывает нужно не просто генерировать числа, а получать детерминированный «случайный» вывод для каждого входа. Например, для аутентификации сообщений. 

PRF — это функция, которая по ключу и произвольному сообщению выдает псевдослучайное значение. Причем зная даже миллионы пар «вход-выход», нельзя предсказать значение для нового входа без ключа. 

По сути, это идеализированная версия хеш-функции с секретом. Поведение функции выглядит абсолютно случайным для внешнего наблюдателя. 

На основе PRF строятся MAC-ы, схемы выработки ключей, эффективные шифры. Это один из самых востребованных примитивов в прикладной криптографии.

***

### Связь PRG и PRF

Интуитивно кажется, что PRF — нечто более сложное, чем PRG. Но оказывается, их можно свести друг к другу. 

Если есть стойкий PRG, из него можно построить PRF — например, через дерево Голдрейха-Гольдвассера-Микали. На каждом шаге бит входной строки решает, какую ветвь PRG вычислять дальше. 

В обратную сторону — еще проще: если зафиксировать сообщение в PRF, она становится PRG. Последовательность F(k, 0), F(k, 1), F(k, 2) будет псевдослучайной. 

Поэтому в криптографии часто доказывают: «достаточно построить стойкий PRG, чтобы получить все остальное». Фундаментальный результат, хотя на практике используют более эффективные конструкции.