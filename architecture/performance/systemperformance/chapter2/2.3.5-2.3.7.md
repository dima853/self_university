# üìä Compliance level and performance analysis  

## üåü **2.3.5 Compliance level**  

Different organizations and environments have different performance requirements. Perhaps you've joined a company where it's common to analyze deeper than you've ever seen (or even thought it was possible!). Or, conversely, in your new job, what you consider to be basic analysis is perceived as something advanced and has never been done before.  

***Good news**: low-hanging fruit! üçè  

This does not mean that some companies are doing everything right and others are not. It all depends on **return on investment (ROI)** in the performance review:  

- **Large data centers or cloud environments** üè¢‚òÅÔ∏è  
  They can afford a team of engineers who analyze everything from the internals of the core to CPU performance counters, use tracing, and even build accurate models to predict growth.  

  üí° *Example*: If a company spends **millions** on computing, even a small improvement will pay off the cost of such a team.  

- **Startups** üöÄ  
  They often limit themselves to superficial checks, relying on third-party monitoring systems.  

  But! Productivity is not only **savings**, but also **user satisfaction**. Even a startup can invest in optimization if a slow website scares away customers.  

- **Extreme environments** ( (for example, exchanges or HFTs)  
  Here ** every millisecond** counts.  

  * *Real-world example*:
> Laying a transatlantic cable between New York and London for **$300 million** reduced transmission delay by **6 ms**!  (The numbers are not accurate) 

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Let's figure out what these transatlantic cables are and how they work. üßê

Imagine a giant fiber-optic "thread" underwater that connects the continents. That's how it works.:

**1. What's inside the cable?**

* **Optical Fiber:** The main "backbone" of the cable. These are the thinnest filaments of very pure glass. They transmit information in the form of light (laser pulses). The light moves at a speed close to the speed of light, which ensures a high data transfer rate.
* **Protective layers:** Optical fiber is very fragile, so it needs to be protected. The cable consists of several layers:
    * **The central element:** Provides durability.
    * **Optical fibers:** Multiple fiber "strands" (there may be dozens or even hundreds of fibers in a single cable).
    * **Softening layers:** Protect the fibers from damage.
    * **Waterproof layer:** Prevents the ingress of water (the main enemy of fiber).
    * **Armored layers:** Protect the cable from damage, such as ship anchors or underwater currents.

**2. How does data transfer work?**

1. **Conversion to light:** Information (data) is converted into light pulses (turning the laser on and off).
2. **Fiber transmission:** Light pulses travel through the fiber at a speed close to the speed of light.
3. **Signal regeneration:** The signal weakens over long distances. Therefore, at certain intervals (usually every 50-100 km) there are amplifiers (regenerators) that "refresh" the signal.
4. **Receiving data:** At the other end of the cable, the light pulses are converted back to data.

**3. How are the cables laid?**

* **Special vessels:** Specialized vessels called cable carriers are used to lay cables.
* **Precise positioning:** The vessel uses GPS for precise positioning.
* **Laying on the ocean floor:** The cable fits neatly on the ocean floor.
* **Protection against damage:** In some places (for example, near the coast), the cable is buried in the ground to protect it from the anchors of ships.

**4. Why is this important for finance?**

* **Speed is money:** Every millisecond is important for high-frequency trading (HFT).
* **Less delay = more profit:** The faster the data gets from the exchange to the trader, the faster decisions can be made and profits can be made.
* **New routes and technologies:** Companies are looking for ways to shorten the distance and improve transmission technology to gain an advantage.
  
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

## üõë **2.3.6 When should the analysis be stopped?**  

The main challenge in performance analysis is to understand **when to stop**. There are so many tools and metrics!  

### üìå Three scenarios to stop:  

1. **When the root cause of the problem is found**  
   *Example from Java*:
```java
try {
       // Code that can cause exceptions
   } catch (Exception e) {
       // Logging exceptions
       logger.error("Error: ", e); // <- It can be expensive!
   }
   ```  
   In one case, exceptions consumed **12% of the CPU**, but the problem was **a 3-fold increase** in load. So, we need to dig further!  

2. **When the ROI of the analysis is less than its cost**
- If optimization saves ** millions** ‚Äî it can take months.  
   - If the benefit is **$100** per year, even an hour of analysis may be excessive.  

3. **When there are more important tasks**  
   Even if the problem is not solved, sometimes it is better to switch to more critical tasks.  

## ‚è≥ **2.3.7 Recommendations at a given time**  

Performance settings **don't last forever**! They depend on:
- üîÑ Software/Hardware updates  
- üë• Increase in the number of users  
- üöÄ Load changes  

‚ö†Ô∏è **Be careful with "tips from the Internet"!**  
Settings that worked for someone may:  
- Be outdated  
- Not suitable for your workload  
- Mask a bug that has already been fixed  

üîß **Tip**:
Store parameter changes in the **version control system** (Git, Puppet, Ansible) to track **when** and **why** they changed.