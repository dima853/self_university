# 🚀 **Caching and Performance Analysis**

## 🌟 **2.3.14 Caching**

Caching is a key system acceleration mechanism that stores frequently used data in high—speed storage.

### 🔹 **How does the cache work?**
- **Multi-level architecture**: From small and fast L1 CPU cache to RAM and disk caches.
- **Example**:  
  > Disk blocks are cached in RAM → Reducing reading delays.

### 📊 **Caching metrics**
1. **Hit Ratio**  
   ```
   hit ratio = hits / (hits + misses)
   ```
   - **90%** → Good  
   - **99%** → Perfect (the difference between 98% and 99% can give **2-3x speedup**!)

2. **Miss Rate (Miss Rate)**
- Shows how many times per second the system is forced to access slow storage.

### 🔥 **Terms: "Hot", "Warm", "Cold" cache**
- **❄️ Cold Cache**: Empty or contains useless data (hit ratio ≈ 0%).  
- **Warm Cache**: Partially filled with useful data.  
- **🔥 Hot Cache**: 99%+ hits (optimal performance).  

**Example**:  
> A server with 128 GB of RAM cache and 600 GB SSD cache warms up **>10 hours** to a "hot" state during random reads from disks (2000 IOPS)!

---

## 🧠 **2.3.15 Known and Unknown (Known-Unknowns)**

### 🔍 **Categories of knowledge in productivity**:
1. **Known-Knowns** (Famous notables):
> Do you know that the CPU is loaded at 10% and how to check it.  

2. **Known-Unknowns** (Known unknowns):
> You know that you can profile the code, but you haven't done it yet.  

3. **Unknown-Unknowns** (Unknown unknowns):  
   > You don't suspect that interrupts can strain the CPU.  

* **The more you know, the more you realize the gaps!**  

---

## 🔎 **2.4 Performance Analysis Perspectives**

### 📉 **1. Resource Analysis**
**For whom**: System administrators, DevOps.  
**Focus**: CPU, memory, disks, network.  

**Metrics**:
- **Utilization** (resource loading)  
- **Saturation** (queues and delays)  
- **IOPS/Throughput** (throughput)  

**Tools**:  
```bash
vmstat 1 # Memory/processes
iostat -x 1 # Disks
mpstat -P ALL 1 # CPU
``

### 📈 **2. Workload Analysis**
**For whom**: Developers, architects.  
**Focus**: How the application uses resources.  

**Metrics**:
- **Latency** (response time)  
- **Request Rate** (RPS/QPS)
- **Error Rate** (5xx errors)  

**Tools**:  
```bash
perf top # CPU Profiling
jaeger # Query Tracing
``

---

## 🛠️ **Practical advice**
1. **Caching**:  
   - Aim for a **hit ratio > 95%**.  
   - Use **LRU/LFU** to manage the cache.  

2. **Analysis**:
- Start with **resource analysis**, then move on to **workload analysis**.  
   - Don't ignore **unknown-unknowns** — Learn new metrics!  

3. **Optimization**:  
   > If the disk subsystem shows **100% utilization**, but **low IOPS**, the problem may be accidental reads (check the RAID/SDD).